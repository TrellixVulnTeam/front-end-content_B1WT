# 浮点数问题

在 js 中，0.1 + 0.2 不等于 0.3

0.1 + 0.2 = 0.30000000000000004
0.1 + 0.2 === 0.3 // false

## 原因

js 只有一种数值类型：number
number 基于IEEE 754标准 的 64位双精度浮点型实现(64位二进制)
IEEE 754 双精度版本（64位）将 64 位分为了三段：第一位表示符号，接下来11位表示指数，其他 52 位数表示有效位

0.1 在二进制中是无限循环的一些数字，其实不只是 0.1，很多十进制小数用二进制表示都是无限循环的
所以在计算机内部存储的是有舍入误差的 0.1，,因此就会出现精度丢失的问题

0.1 和 0.2 通过这个标准实现的二进制浮点数不精确，所以导致该问题的出现

## 解决

- `(0.1 * 10 + 0.2 * 10) / 10`
- `(0.1 + 0.2).toFixed(10)`

## 银行家算法

JS 的 toFixed 采用银行家算法，即：
四舍六入五考虑，五后非零就进一，五后为零看奇偶，五前为偶应舍去，五前为奇要进一

以4为舍入位：
var num = 0.094;
console.log(num.toFixed(2)); // 0.09

以6为舍入位：
var num = 0.096;
console.log(num.toFixed(2)); // 0.10

以5为舍入位(5后非零)：
var num = 0.0052;
console.log(num.toFixed(2)); // 0.01

以5为舍入位(5后为零)：
var num = 0.035;
console.log(num.toFixed(2)); // 0.04

但由于浮点数计算精度缺失的问题，以5为舍入位仍然会出现计算问题
