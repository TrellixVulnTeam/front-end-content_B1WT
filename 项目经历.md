# 项目经历

## 项目内容

这个项目叫做直升机故障智能诊断及预测系统，是跟成都某个军工直升机维修所合作的
这个系统的主要功能是对直升机的一些关键参数做实时监测；以及对一些异常数据进行一些算法分析，最终通过对参数分析的结果来判断出直升机的故障类型；
同时还有一个维护页面，上面能够查询以及管理一些维护任务卡，可供直升机厂相关人员安排对直升机的维护任务
这个项目的整体架构是一个 C/S和B/S结合的方式，B/S端主要是面向用户，让用户对页面进行交互操作，而C/S端主要是用来处理数据，对一些异常数据通过跑一些算法从而检测出故障的类型
而我在这个项目里主要是在B/S端对页面进行一些设计

## 个人职责

1. 利用 websocket 与后端建立长连接通信，将后端发来的实时数据渲染到数据监测页面的 Echarts图表上，实现对数据的可视化处理
直升机主要分为三个部分，分别是旋翼、转减速器和发动机，每个部分要对两个关键参数进行监测，所以我将 echarts 图表封装成一个组件，然后在监测页面放了6个这个图表组件，服务端每次都会把实时数据放进一个数组传过来，我按照索引值将每个参数对应的数据传入对应的组件内进行渲染。
2. 在故障诊断页面通过用户选择对应的参数来对服务端发出 axios 请求，服务端响应后会将该参数的异常数据发来，然后将这些数据渲染到 echarts 图表上
然后同时服务端会将异常参数发给C/S端，C/S端会用这些参数跑一些算法，比如说小波分析、随机森林、SVM、KNN算法等，跑完会得到一个结果，服务端同时会将这个结果发给我，不同的结果对应不同的故障类型，我把这个结果存到 vuex 中，供多个页面公共使用
同时，故障诊断页面上还有一个故障树，这个也是用 echarts 做的，当有故障结果发给我时，故障树上对应的故障节点就会变红，提醒用户诊断结果是这个故障
3. 在维护支持页面对维护任务进行管理，包括向后端调取任务列表上的数据，以及对任务列表上的单个任务进行修改或删除任务，同时还能新建任务，当用户填写完相关的内务内容后，点击新建任务就会将该任务发送请求存入数据库，同时渲染到任务列表中

## 任务难点

我觉得项目的难点可能是 echarts 图表渲染的问题吧，因为同一个页面上要动态渲染 6 个 echarts 图表，而且实时传输的频率也很高（大概10ms传一次），所以就会导致这个页面运行几十分钟以后图表的渲染就会慢慢开始有点卡顿
然后我觉得问题可能是出在与后端的长连接通信上，认为可能是实时接收数据很占资源，所以就用了 webWorker 试了一下，把专门用于接收 websocket 传来的数据以及处理数据的那部分放到子线程里去执行，后来发现并没有太大的优化，过久了以后还是会卡顿
所以就去网上搜了一下，发现可以用 echarts 的 sampling（降采样策略），这个属性就是 echarts 提供的专门用于数据量太大以至于远远大于像素点的时候用的一种方法，它虽然会导致信息的丢失，但是能够保留折线的整体趋势，所以对于这些直升机系统来说，只要能够监测到它运行时的整体趋势就够了，不需要对详细的数据进行展示
同时，在通过 axios 获取异常数据的图表中，由于该图表中的数据是静态的（过去某一时间段的数据），所以我用了 dataZoom 组件，该组件用于自由缩放，由用户来指定自己想要关注的数据信息，既可以观察数据细节，又可以观察到数据整体，这也是图表展示的一种优化方式
